{% extends 'core/base.html' %}
{% load static %}

{% block title %}{% if mode == 'edit' %}Modifier{% else %}Nouveau{% endif %} Témoignage — SAM EMPIRE{% endblock %}
{% block body_class %}page-gestion{% endblock %}

{% block content %}
<nav class="navbar scrolled" style="background:rgba(10,10,15,.98)!important;">
<div class="nav-container">
    <a href="{% url 'index' %}" class="nav-logo"><img src="{% static 'images/SAM.png' %}" alt="SAM EMPIRE" style="height:50px;width:auto;"></a>
    <div style="display:flex;align-items:center;gap:1.5rem;">
        <a href="{% url 'gestion_temoignages' %}" style="color:var(--text-light);font-size:.85rem;">← Retour aux témoignages</a>
        <a href="{% url 'gestion_logout' %}" class="btn-outline" style="padding:.5rem 1.2rem;font-size:.82rem;">Déconnexion</a>
    </div>
</div>
</nav>

<section style="padding:120px 0 4rem;min-height:100vh;background:var(--dark-bg);">
<div class="container" style="max-width:700px;">
    {% if messages %}
    <div style="margin-bottom:2rem;">{% for message in messages %}<div class="alert alert-{{ message.tags }}" style="position:relative;">{{ message }}</div>{% endfor %}</div>
    {% endif %}

    <h1 style="font-family:var(--font-display);font-size:2rem;font-weight:700;margin-bottom:2rem;">
        {% if mode == 'edit' %}Modifier le témoignage{% else %}Nouveau témoignage{% endif %}
    </h1>

    <div class="contact-form-wrapper" style="padding:2.5rem;">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-row">
                <div class="form-group">
                    <label for="nom_client">Nom du client *</label>
                    <input type="text" id="nom_client" name="nom_client" value="{{ temoignage.nom_client|default:'' }}" placeholder="Ex: Jean Dupont" required>
                </div>
                <div class="form-group">
                    <label for="entreprise">Entreprise / Secteur</label>
                    <input type="text" id="entreprise" name="entreprise" value="{{ temoignage.entreprise|default:'' }}" placeholder="Ex: Événementiel">
                </div>
            </div>
            <div class="form-group">
                <label for="texte">Texte du témoignage *</label>
                <textarea id="texte" name="texte" style="min-height:120px;" placeholder="Le témoignage du client..." required>{{ temoignage.texte|default:'' }}</textarea>
            </div>
            <div class="form-group">
                <label for="image">Capture d'écran du témoignage *</label>
                <input type="file" id="image" name="image" accept="image/*" style="padding:.7rem;" {% if mode == 'create' %}required{% endif %}>
                {% if temoignage.image %}
                <div style="margin-top:.8rem;">
                    <img src="{{ temoignage.image.url }}" alt="Capture actuelle" style="max-width:200px;border-radius:8px;border:1px solid var(--dark-border);">
                    <small style="display:block;color:var(--accent-green);font-size:.75rem;margin-top:.3rem;">Image actuelle (laissez vide pour garder)</small>
                </div>
                {% endif %}
            </div>
            <div class="form-group" style="margin-top:1rem;">
                <label style="display:flex;align-items:center;gap:.8rem;cursor:pointer;">
                    <input type="checkbox" name="publie" {% if temoignage.publie or mode == 'create' %}checked{% endif %} style="width:18px;height:18px;accent-color:var(--primary-blue);">
                    <span>Publier ce témoignage</span>
                </label>
            </div>
            <div style="display:flex;gap:1rem;margin-top:2rem;">
                <button type="submit" class="form-submit" style="flex:1;">
                    {% if mode == 'edit' %}Enregistrer{% else %}Ajouter le témoignage{% endif %}
                </button>
                <a href="{% url 'gestion_temoignages' %}" class="btn-outline" style="padding:1rem 1.5rem;">Annuler</a>
            </div>
        </form>
    </div>
</div>
</section>
{% endblock %}
